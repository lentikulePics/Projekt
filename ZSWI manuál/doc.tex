\documentclass[12pt, a4paper]{article}
\usepackage[cp1250]{inputenc}
\usepackage[IL2]{fontenc}
\usepackage[czech]{babel}
\usepackage{graphicx}
\usepackage[hidelinks]{hyperref}
\usepackage{pdfpages}
\usepackage{listings}
\usepackage{multirow}

\begin{document}
\lstset{language=Java, keywordstyle=\color{blue}}

%titulní strana
\thispagestyle{empty}
\begin{center}
{\Huge Manuál ke zdrojovému kódu aplikace Interlacer}
\end{center}
\vfill
\newpage
%konec titulní strany

%obsah
\tableofcontents
\thispagestyle{empty}
\newpage
%konec obsahu
\section{Úvod}
Tento dokument slouí pro snadnìjší orientaci ve zdrojovém kódu jako celku.
Obsahuje struènı popis nìkterıch dùleitıch tøíd a popis souvislostí mezi jednotlivımi èastmi aplikace.
\par
Dále také obsahuje návod na pouití prokládacího mechanismu jako samostatné èásti pro vytvoøení vıstupního lentikulárního obrázku.
\par
Podrobnìjší popis jednotlivıch tøíd, jejich atributù a metod se nachází pøímo ve zdrojovém kódu.

\section{GfxlibWrapper}
GfxlibWrapper je skupina tøíd, které se starají o komunikace s knihovnou Magick++.
Jsou v projektu v samostatné sloce a ke svojí plné funkènosti potøebují, aby se v adresáøi odkud je aplikace spuštìna, nacházel soubor Gfxlib.dll, jeho zdrojové kódy v C++ se nacházejí v oddìleném projektu Gfxlib.
\subsection{Tøída Picture}
Picture je tøída pro reprezentaci jednotlivıch obrázkù.
Instanci této tøídy lze vytvoøit dvìma konstruktory:
\begin{lstlisting}
public Picture(int width, int height)
\end{lstlisting}
- vytvoøí obrázek o zadané šíøce a vıšce

\begin{lstlisting}
public Picture(String filename)
\end{lstlisting}
- vytvoøí instanci tøídy a nastaví, z jakého souboru má bıt obrázek naèten, samotné naètení ale provedeno zatím není

Pro naètení obrázku je pak potøeba pouít metodu Load, která naète obrázek ze souboru, jeho název byl pøedán právì tímto konstruktorem.
Lze také pouít metodu Ping, která pouze naète informace o obrázku (šíøku a vıšku v px, rozlišení...) ale samotná obrazová data naètena nejsou.\\\\
Infromaci, zda byl obrázek ji vytvoøen, a u prvním konstruktorem nebo naètením metodou Load (ne Ping) lze zjistit metodou IsCreated.\\\\
Po skonèení práce s obrázkem je dobré zavolat metodu Destroy, která provede dealokaci pamìti.
Metoda Destroy se sice volá sama v destruktoru, ale ten je volán garbage collectorem a to se mùe stát a v pøípadì, kdy na instanci neexistují reference.\\\\
K uloení slouí metoda Save, které staèí parametrem pøedat název nebo celou cestu vısledného souboru. Formát uloeného souboru je rozpoznán z koncovky.
Napøíklad koncovka .jpg zajistí uloení do formátu JPEG.

\subsection{Filtry pro zmìnu velikosti}
Tøída FilterType obsahuje 4 statické instance sama sebe. Kadná z tìchto instancí reprezentuje jeden typ interpolaèního filteru, kterı lze pouí pro zmìnu velikosti obrázku metodou Resize.

Filtery lze pouít napøíklad takto:
\begin{lstlisting}
Picture picture = new ...;
picture.Resize(500, 400, FilterType.Cubic);
\end{lstlisting}
Tento kód zmìní velikost obrázku z pùvodní na 500x400 pixelù s pouitím kubické interpolace.

\subsection{Jednotky}
Vıètovı typ Units obsahuje tøi prvky, kadı z nich reprezentuje jiné jednotky.\\
In - palce\\
Cm - centimetry\\
Mm - milimetry\\


GfxlibWrapper také obsahuje statickou tøídu UnitConverter (v souboru Units.cs), která obsahuje nìkolik metod pro pøevody jednotek.

\section{Prokládání}
\subsection{Tøída PictureContainer}
O samotné prokládání se stará tøída PictureContainer.
Nejdøíve je potøeba vytvoøit její instanci, tøída má pouze jeden konstruktor.
\begin{lstlisting}
public PictureContainer(List<Picture> pictures,
InterlacingData interlacingData, LineData lineData,
ProgressBar progressBar = null)
\end{lstlisting}
Prvním parametrem je seznam obrázkù k proloení v podobì instance tøidy List, kde kadı obrázek je reprezentován instancí tøidy Picture z GfxlibWrapperu.\\\\
Druhım parametrem je instance tøídy InterlacingData, která obsahuje všechny parametry prokládání, viz níe.\\\\
Tøetím parametrem je instance tøídy LineData, která obsahuje všechny parametry pasovacích znaèek, viz níe.\\\\
Posledním parametrem je instance tøídy System.Windows.Forms.ProgressBar, která je pak pouita pro zobrazení postupu prokládání. Pokud je progressBar nastaven na null, postup nebude ukázán nikde, ale prokládání bude fungovat.\\\\
Pøed samotnım proloením je potøeba zavolat metodu CheckPictures, pokud nebude zavolána, prokládání sele a vyhodí vıjimku.
Tato metoda zkontroluje velikost všech obrázkù, pokud bude u všech stejná, vrátí true a pøi prokládání budou obrázky proloeny tak, jak jsou.
Pokud obrázky nebudou stejnì velké, vrátí false a pøi prokládání pak budou všechny obrázky oøíznuty na šíøku nejušího a vıšku nejnišího.\\\\
Pro proloení pak staèí zavolat metodu Interlace a poté metodou GetResult získat vıslednı obrázek v podobì instance tøídy Picture.\\\\
Obrázky, které ji byly naèteny pøed prokládáním nebo byly vytvoøeny prvním konstrutkorem (tedy vdy, kdy metoda IsCreated vrací true) budou rovnou pouity.
Obrázky, které byly vytvoøeny druhım konstruktorem a pøed prokládáním nebyly naèteny (tedy ty, jejich metoda IsCreated vrací false) budou naèteny pøi prokládání a po nìm rovnou smazány metodou Destroy.

\subsection{Tøída InterlacingData}
Tato tøída obsahuje všechny parametry prokládání (šíøka, vıška a rozlišení vıstupního obrázku, informace o pouitıch jednotkách, hustota èoèek lentikulární desky, interpolaèní filtry pro obì fáze zmìny velikosti a smìr prokládání) a její instance je pro proloení potøeba.
Obsahuje pouze atributy a settery a gettery. Jednotky pro rozmìry je moné zmìnit metodou SetUnits, jednotky pro rozlišení a hustotu èoèek je moné zmìnit metodou SetResolutionUnits. Obì metody rovnou pøepoèítají aktuální hodnoty.
Jakákoliv hodnota nastavená kterımkoliv setterm se pøedpokládá v jednotkách, které jsou aktuálnì nastaveny.
Metodou KeepAspectRatio lze vypnout nebo zapnout funkci pro zachování pomìru stran. Pokud je zapnuta, pak pøi zmìnì šíøky nebo vıšky je automaticky pøepoèítán i druhı rozmìr.
Pøed pouitím instance pro proloení je potøeba pomocí setterù nastavit všechny parametry.

\subsection{Tøída LineData}
Tato tøída obsahuje všechny parametry pasovacích znaèek (šíøku a barvu èar, barvu pozadí, šíøku rámeèku s èarami, odsazení, informace na kterıch okrajích èáry mají bıt, informaci zda mají bıt zarovnány na støed nebo ke kraji) a její instance je pro proloení potøeba.
Obsahuje pouze atributy a settery a gettery. Jednotky pro šíøku rameèku a odsazení je moné zmìnit metodou SetUnits, která obì hodnoty rovnou pøepoèítá.
Jakákoliv hodnota nastavená kterımkoliv setterm se pøedpokládá v jednotkách, které jsou aktuálnì nastaveny.
Pøed pouitím instance pro proloení je potøeba pomocí setterù nastavit všechny parametry.


\section{Propojení s GUI}
Hlavní tøídou GUI je tøída MainForm. Ta je rozdìlena do dvou souborù MainForm.cs a MainFormEvents.cs.\\\\
Prokládání se nachází v metodì události na stisknutí tlaèítka pro proloení a to vèetnì vytvoøení instance tøídy PictureContainer.\\\\
Tøída MainForm obsahuje instanci tøídy ProjectData, která v sobì má instance tøíd InterlacingData a LineData, stará se také o naèítání a ukládání projektù.\\\\
Po jakékoliv zmìnì komponent formuláøe jsou rovnou nové hodnoty zaneseny do InterlacingData a LineData v instanci tøídy ProjectData.
Zároveò je zavolána metoda UpdateAllComponents, která zajistí, e jsou do všech komponent dodány aktuální hodnoty z InterlacingData a LineData.\\\\
Tøída MainForm obsahuje instanci tøídy Settings, která obsahuje informaci o aktuálním nastavení aplikace. Informace o tom, co vše lze nastavit je pøedávána prostøednictvím instance tøídy SettingOptions.
Tøída SettingOptions obsahuje pouze tøi Listy, první obsahuje nastavitelné jazyky, druhı nastavitelné délkové jednotky a tøetí nastavitelné jednotky rozlišení.
Všechny tyto poloky jsou reprezentovány instancemi tøídy StringValuePair, která slouí k tomu, e vytvoøí dvojici (Jméno, Objekt), kde jméno je typu String a je vraceno metodou toString, Objekt je pak libovolnı objekt, kterı má bıt takto pojmenován.
Tyto dvojice v podobì instancí tøídy StringValuePair jsou pak vkládány do ComboBoxù formuláøe a pøi zmìnì jazyka se vytvoøí dvojice nové s pojmenováním v daném jazyce a jsou dodány do ComboBoxù.
O vytvoøení tìchto dvojic se stará metoda createSettingOptions, která je vrací v podobì instance tøídy SettingOptions. Metoda ApplySettings zaøídí promítnutí zmìn v instanci tøídy Settings do formuláøe.\\\\
Tøída MainForm obsahuje instanci tøidy PictureInfoData, která se stará o získávání informací o obrázcích kvùli zobrazení v dolním pravém rohu formuláøe. Informace o obrázcích si uchovává, aby nebylo nutné stejnı obrázek naèítat vícekrát.
O samotné zobrazení tìchto informací se stará metoda setPictureInfo, metoda resetPictureInfo pak nastaví potøebné labely na prázdné øetìzce.\\\\
Tøída MainForm obsahuje instanci tøídy PreviewData, která se stará o zobrazování náhledù. Uchovává si naètené obrázky, aby nebylo potøeba naèítat stejnı obrázek vícekrát.
V tøídì MainForm je zobrazení náhledu øešeno v metodì setPreview.
\section{Lokalizace aplikace}
Aplikace je pøeloena do dvou jazykù. Do èeštiny a angliètiny. Nastavení jazyka je mono provést v aplikaci v menu \verb|nastavení|. Zmìna jazyka se projeví ihned po stisknutí tlaèítka \verb|OK| nebo tlaèítka \verb|apply|. Nastavení jazyka se po ukonèení aplikace uloí do souboru a pøi opìtovném spuštìní si aplikace nastavení jazyka z tohoto souboru naète.

\subsection{Pøidání textu komponentì}
Døíve, ne pøidáváme jakoukoliv novou komponentu do aplikace nebo upravujeme text ji vytvoøené komponenty, ujistíme se, e formuláøi, do kterého komponentu pøidáváme, je nastavena hodnota Language na \verb|default|. To znamená, e formuláø je právì nastaven na anglickı jazyk a veškeré texty komponent budeme zadávat v anglickém jazyce. Po zadání textu komponentì se její text vèetnì jejích atributù ihned uloí do resource souboru \verb|MainForm.resx|. Pro pøeklad textu komponenty do èeského jazyka pøepneme formuláøi nastavení hodnoty Language na \verb|Czech (Czech republic)|, nikoliv pouze \verb|Czech|. Stejnım zpùsobem pøidáme text komponentì, nyní v èeském jazyce. Text se uloí do resource souboru \verb|MainForm.cs-CZ.resx|.
\subsection{Pøidání jiného textu}
Pokud pøidáváme jakıkoliv jinı text (vıpis chybové hlášky, tooltip komponenty, poloky comboboxù...), musíme dané texty pøidat do resource souborù manuálnì. Pro kadı jazyk je vytvoøen zvláštní resource soubor oddìlenı od hlavního souboru s texty komponent. Pro èeštinu se nazıvá \verb|StringRes_CZ.resx| a pro angliètinu \verb|StringRes_EN.resx|. Pokud tedy napøíklad pøidáváme novou chybovou hlášku, v resource souborech jí pøidìlíme nìjaké jméno (sloupec \verb|Name|), pod kterım k ní budeme pøistupovat a do sloupce \verb|Value| napíšeme v odpovídajícím jazyce její text. V kodu budeme k tìmto textùm pøistupovat pomocí statické tøídy \verb|Localization|. V této tøídì je definovanı ComponentResourceManager nazvanı \verb|resourcesStrings| pomocí nìho budeme pøistupovat k tìmto resource souborùm. Jsou tam definovány ještì dva další ComponentResourceManagery, kadı pro správu jednoho formuláøe.

Pøíklad pøístupu k textu pomocí jeho jména:
\begin{lstlisting}
Localization.resourcesStrings.GetString("Name")
\end{lstlisting}
\end{document}